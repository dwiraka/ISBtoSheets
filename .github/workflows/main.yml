name: Daily Node.js Script

on:
  schedule:
  - cron: '0 0,2,4,6,8 * * *'  # Every 2 hours from 12 AM to 8 AM UTC
  workflow_dispatch:  # Allows manual triggering

jobs:
  build:
    runs-on: ubuntu-latest

    steps:
    - name: Checkout code
      uses: actions/checkout@v3

    - name: Set up Node.js
      uses: actions/setup-node@v3
      with:
        node-version: '16'  # Specify your Node.js version here

    - name: Install dependencies
      run: npm install

    - name: Run Penyedia Node.js script
      run: node Penyedia_Terumumkan_TahunLama.js
      env:
        GOOGLE_SHEET_KEY_JSON: ${{ secrets.GOOGLE_SHEET_KEY_JSON }}
        API_URL_PEN: ${{ secrets.API_URL_PENLM }}
        SPREADSHEET_ID: ${{ secrets.SPREADSHEET_ID }}

    - name: Run Penyedia Node.js script
      run: node Penyedia_Terumumkan_TahunBaru.js
      env:
        GOOGLE_SHEET_KEY_JSON: ${{ secrets.GOOGLE_SHEET_KEY_JSON }}
        API_URL_PEN: 'https://isb.lkpp.go.id/isb-2/api/63e238a3-3b49-4a1c-9f19-2f939a7624c6/json/23546/RUP-PaketPenyedia-Terumumkan/tipe/4:12/parameter/2025:D27'
        SPREADSHEET_ID: ${{ secrets.SPREADSHEET_ID }}

    - name: Run Swakelola Node.js script
      run: node Swakelola_Terumumkan.js
      env:
        GOOGLE_SHEET_KEY_JSON: ${{ secrets.GOOGLE_SHEET_KEY_JSON }}
        API_URL_SWA: 'https://isb.lkpp.go.id/isb-2/api/a2450e70-239e-4e8f-a448-f41ab2a3c87d/json/23522/RUP-PaketSwakelola-Terumumkan/tipe/4:12/parameter/2025:D27'
        SPREADSHEET_ID: ${{ secrets.SPREADSHEET_ID }}

    - name: Run Instansi Satker Node.js script
      run: node InstansiSatker.js
      env:
        GOOGLE_SHEET_KEY_JSON: ${{ secrets.GOOGLE_SHEET_KEY_JSON }}
        API_URL_IS: 'https://isb.lkpp.go.id/isb-2/api/b52eb8ff-53f8-4053-b072-cd651658caea/json/23514/RUP-MasterSatker/tipe/12:12/parameter/D27:2025'
        SPREADSHEET_ID: ${{ secrets.SPREADSHEET_ID }}

    - name: Run Tender Selesai Node.js script
      run: node Tender_Selesai.js
      env:
        GOOGLE_SHEET_KEY_JSON: ${{ secrets.GOOGLE_SHEET_KEY_JSON }}
        API_URL_TS: 'https://isb.lkpp.go.id/isb-2/api/8c0d2885-dd7f-43d2-83d5-3460d06f86d5/json/23548/SPSE-TenderSelesai/tipe/4:4/parameter/2025:17'
        SPREADSHEET_ID: ${{ secrets.SPREADSHEET_ID }}

    - name: Run Tender Selesai Nilai Node.js script
      run: node Tender_Selesai_Nilai.js
      env:
        GOOGLE_SHEET_KEY_JSON: ${{ secrets.GOOGLE_SHEET_KEY_JSON }}
        API_URL_TSN: ${{ secrets.API_URL_TSN }}
        SPREADSHEET_ID: ${{ secrets.SPREADSHEET_ID }}

    - name: Run Tender Selesai Pengumuman Node.js script
      run: node Tender_Selesai_Pengumuman.js
      env:
        GOOGLE_SHEET_KEY_JSON: ${{ secrets.GOOGLE_SHEET_KEY_JSON }}
        API_URL_TSP: ${{ secrets.API_URL_TSP }}
        SPREADSHEET_ID: ${{ secrets.SPREADSHEET_ID }}

    - name: Run Non Tender Selesai Node.js script
      run: node NonTender_Selesai.js
      env:
        GOOGLE_SHEET_KEY_JSON: ${{ secrets.GOOGLE_SHEET_KEY_JSON }}
        API_URL_NTS: ${{ secrets.API_URL_NTS }}
        SPREADSHEET_ID: ${{ secrets.SPREADSHEET_ID }}

    - name: Run Pencatatan Non Tender Node.js script
      run: node Pencatatan_NonTender.js
      env:
        GOOGLE_SHEET_KEY_JSON: ${{ secrets.GOOGLE_SHEET_KEY_JSON }}
        API_URL_PNT: ${{ secrets.API_URL_PNT }}
        SPREADSHEET_ID: ${{ secrets.SPREADSHEET_ID }}

    - name: Run Pencatatan Swakelola Node.js script
      run: node Pencatatan_Swakelola.js
      env:
        GOOGLE_SHEET_KEY_JSON: ${{ secrets.GOOGLE_SHEET_KEY_JSON }}
        API_URL_PS: ${{ secrets.API_URL_PS }}
        SPREADSHEET_ID: ${{ secrets.SPREADSHEET_ID }}

    - name: Run E-Purchasing Node.js script
      run: node E-Purchasing.js
      env:
        GOOGLE_SHEET_KEY_JSON: ${{ secrets.GOOGLE_SHEET_KEY_JSON }}
        API_URL_EP: ${{ secrets.API_URL_EP }}
        SPREADSHEET_ID: ${{ secrets.SPREADSHEET_ID }}

    - name: Run TokoDaring Node.js script
      run: node TokoDaring.js
      env:
        GOOGLE_SHEET_KEY_JSON: ${{ secrets.GOOGLE_SHEET_KEY_JSON }}
        API_URL_TD: ${{ secrets.API_URL_TD }}
        SPREADSHEET_ID: ${{ secrets.SPREADSHEET_ID }}
